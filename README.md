# DeployGate Resource

This is a write-only resource that enables to upload IPA/APK packages to DeployGate.

## Source Configuration

- `api_key` (string): __*Required.*__ API key of a member or a group.
- `owner` (string): __*Required.*__ User name or group name.

## Behaviour

### `out`: Push an app to DeployGate.

Upload the app package specified by `file` to DeployGate.

#### Parameters

- `file` (string): __*Required.*__ Path to the `*.ipa` or `*.apk` file to upload.
- `message` (string): *Optional.* Description of the uploaded file.
- `message_file` (string): *Optional.* Path to a text file containing message.
  Use this instead of `message` to add a message dynamically generated by some tasks.
  If `message_file` is specified, `message` is ignored.
- `distribution_key` (string): *Optional.* Hash key of distribution page.
  If specified, updates distribution page.
- `distribution_name` (string): *Optional.* Name of distribution page to update.
  If not exists, new distribution page will be created with specified name.
- `release_note` (string): *Optional.* Message added to distribution page when updated.
- `disable_notify` (bool): *Optional.* If *true*, disables e-mail notification (iOS only).
- `visibility` (string): *Optional.* This is ignored when updating existing apps.

These parameters are corresponding to [DeployGate API](https://docs.deploygate.com/reference#upload).
For more exact information, please refer to this official document.

## Example Configuration

### Resource Configuration

```yaml
resource_types:
  - name: deploygate
    type: docker-image
    source:
      repository: yuukiaria/deploygate-resource

resources:
  - name: deploygate
    type: deploygate
    source:
      api_key: ((your-api-key))
      owner: mygroup
```

### Upload with a simple message

```yaml
jobs:
  - name: publish-to-deploygate
    plan:
      - task: build-apk
        file: ci/build-task # your build task that produces builds/myapp.apk
      - put: deploygate
        params:
          file: builds/myapp.apk
          message: This is a new release
```

### Upload with a generated message


```yaml
jobs:
  - name: publish-to-deploygate
    plan:
      - task: build-apk
        file: ci/tasks/build-task # your build task that produces builds/myapp.apk
      - task: create-message
        file: ci/tasks/create-message
      - put: deploygate
        params:
          file: builds/myapp.apk
          message_file: message/message.txt
```
